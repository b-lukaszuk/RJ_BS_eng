<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Bartlomiej Lukaszuk" />
  <title>Post-hoc tests - Romeo and Julia, where Romeo is Basic Statistics</title>
  <link rel="stylesheet" href="./style.css"/>
    <script src="./mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("./JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="./github.min.css">
<script src="./highlight.min.js"></script>
<script src="./julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="./">Romeo and Julia, where Romeo is Basic Statistics</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="./about.html"><b>1</b> About</a></li>
<li><a class="menu-level-1" href="./why_julia.html"><b>2</b> Why Julia</a></li>
<li><a class="menu-level-2" href="./julia_is_fast.html"><b>2.1</b> Julia is fast</a></li>
<li><a class="menu-level-2" href="./julia_is_simple.html"><b>2.2</b> Julia is simple</a></li>
<li><a class="menu-level-2" href="./jl_pleasure_to_write.html"><b>2.3</b> Pleasure to write</a></li>
<li><a class="menu-level-2" href="./jl_not_mainstream.html"><b>2.4</b> Not mainstream</a></li>
<li><a class="menu-level-2" href="./jl_open_source.html"><b>2.5</b> Julia is free</a></li>
<li><a class="menu-level-1" href="./julia_first_encounter.html"><b>3</b> Julia - first encounter</a></li>
<li><a class="menu-level-2" href="./julia_installation.html"><b>3.1</b> Installation</a></li>
<li><a class="menu-level-2" href="./julia_language_constructs.html"><b>3.2</b> Language Constructs</a></li>
<li><a class="menu-level-2" href="./julia_language_variables.html"><b>3.3</b> Variables</a></li>
<li><a class="menu-level-2" href="./julia_language_functions.html"><b>3.4</b> Functions</a></li>
<li><a class="menu-level-2" href="./julia_language_decision_making.html"><b>3.5</b> Decision Making</a></li>
<li><a class="menu-level-2" href="./julia_language_repetition.html"><b>3.6</b> Repetition</a></li>
<li><a class="menu-level-2" href="./julia_language_libraries.html"><b>3.7</b> Additional libraries</a></li>
<li><a class="menu-level-2" href="./julia_language_exercises.html"><b>3.8</b> Julia - Exercises</a></li>
<li><a class="menu-level-2" href="./julia_language_exercises_solutions.html"><b>3.9</b> Julia - Solutions</a></li>
<li><a class="menu-level-1" href="./statistics_intro.html"><b>4</b> Statistics - introduction</a></li>
<li><a class="menu-level-2" href="./statistics_intro_imports.html"><b>4.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./statistics_intro_probability_definition.html"><b>4.2</b> Probability - definition</a></li>
<li><a class="menu-level-2" href="./statistics_intro_probability_properties.html"><b>4.3</b> Probability - properties</a></li>
<li><a class="menu-level-2" href="./statistics_prob_theor_practice.html"><b>4.4</b> Probability - theory and..</a></li>
<li><a class="menu-level-2" href="./statistics_prob_distribution.html"><b>4.5</b> Probability distribution</a></li>
<li><a class="menu-level-2" href="./statistics_normal_distribution.html"><b>4.6</b> Normal distribution</a></li>
<li><a class="menu-level-2" href="./statistics_intro_hypothesis_testing.html"><b>4.7</b> Hypothesis testing</a></li>
<li><a class="menu-level-2" href="./statistics_intro_exercises.html"><b>4.8</b> Statistics intro - Exerc..</a></li>
<li><a class="menu-level-2" href="./statistics_intro_exercises_solutions.html"><b>4.9</b> Statistics intro - Solut..</a></li>
<li><a class="menu-level-1" href="./compare_contin_data.html"><b>5</b> Comparisons - continuous d..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_imports.html"><b>5.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_one_samp_ttest.html"><b>5.2</b> One sample Student’s t..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_two_samp_ttest.html"><b>5.3</b> Two samples Student’s ..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_one_way_anova.html"><b>5.4</b> One-way ANOVA</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_post_hoc_tests.html"><b>5.5</b> Post-hoc tests</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_multip_correction.html"><b>5.6</b> Multiplicity correction</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_exercises.html"><b>5.7</b> Exercises - Comparisons ..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_exercises_solutions.html"><b>5.8</b> Solutions - Comparisons ..</a></li>
<li><a class="menu-level-1" href="./compare_categ_data.html"><b>6</b> Comparisons - categorical ..</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_imports.html"><b>6.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_flashback.html"><b>6.2</b> Flashback</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_chisq_test.html"><b>6.3</b> Chi squared test</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_fisher_exact_text.html"><b>6.4</b> Fisher’s exact test</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_bigger_table.html"><b>6.5</b> Bigger table</a></li>
<li><a class="menu-level-2" href="./compare_categ_test_for_independence.html"><b>6.6</b> Test for independence</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_exercises.html"><b>6.7</b> Exercises - Comparisons ..</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_exercises_solutions.html"><b>6.8</b> Solutions - Comparisons ..</a></li>
<li><a class="menu-level-1" href="./association.html"><b>7</b> Association</a></li>
<li><a class="menu-level-2" href="./assoc_and_pred_data_imports.html"><b>7.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./association_lin_relation.html"><b>7.2</b> Linear relation</a></li>
<li><a class="menu-level-2" href="./assocociation_covariance.html"><b>7.3</b> Covariance</a></li>
<li><a class="menu-level-2" href="./assoc_and_pred_correlation.html"><b>7.4</b> Correlation</a></li>
<li><a class="menu-level-2" href="./association_corr_pitfalls.html"><b>7.5</b> Correlation Pitfalls</a></li>
<li><a class="menu-level-1" href="./appendix.html"><b></b> Appendix</a></li>
<li><a class="menu-level-1" href="./references.html"><b>8</b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="5.5" id="sec:compare_contin_data_post_hoc_tests"><span class="header-section-number">5.5</span> Post-hoc tests</h2>
<p>Let’s start with a similar example to the ones we already met.</p>
<p>Imagine that you are a scientist and in the Amazon rain forest you discovered two new species of mice (<code>spB</code>, and <code>spC</code>). Now, you want to compare their body masses with and ordinary lab mice (<code>spA</code>) so you collect the data. If the body masses differ perhaps in the future they will become the criteria for species recognition.</p>
<pre class="language-julia"><code># if you are in &#39;code_snippets&#39; folder, then use: &quot;./ch05/miceBwtABC.csv&quot;
# if you are in &#39;ch05&#39; folder, then use: &quot;./miceBwtABC.csv&quot;
miceBwtABC = Csv.read(&quot;./code_snippets/ch05/miceBwtABC.csv&quot;, Dfs.DataFrame)
</code></pre>
<div id="tbl:mBwtABCDf">
<table>
<caption>Table 4: Body mass [g] of three mice species.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">spA</th>
<th style="text-align: right;">spB</th>
<th style="text-align: right;">spC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">18</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: right;">21</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: right;">23</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="odd">
<td style="text-align: right;">22</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: right;">19</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">26</td>
</tr>
</tbody>
</table>
</div>
<p>Now, let us quickly look at the means and standard deviations in the three groups to get some impression about the data.</p>
<pre class="language-julia"><code>[
(n, Stats.mean(miceBwtABC[!, n]), Stats.std(miceBwtABC[!, n]))
    for n in Dfs.names(miceBwtABC)
]</code></pre>
<pre class="output"><code>(&quot;spA&quot;, 20.5, 1.8708286933869707)</code></pre>
<pre class="output"><code>(&quot;spB&quot;, 23.5, 2.073644135332772)</code></pre>
<pre class="output"><code>(&quot;spC&quot;, 26.0, 1.7888543819998317)</code></pre>
<p>Here, the function <code>Dfs.names</code> returns <code>Vector{T}</code> with names of the columns. In connection with comprehensions we met in Section <a href="./julia_language_repetition.html#sec:julia_language_comprehensions">3.6.3</a> it allows us to quickly obtain the desired statistics without typing the names by hand. Alternatively we would have to type</p>
<pre>
[
("spA", Stats.mean(miceBwtABC[!, "spA"]), Stats.std(miceBwtABC[!, "spA"])),
("spB", Stats.mean(miceBwtABC[!, "spB"]), Stats.std(miceBwtABC[!, "spB"])),
("spC", Stats.mean(miceBwtABC[!, "spC"]), Stats.std(miceBwtABC[!, "spC"])),
]
</pre>
<p>It didn’t save us a lot of typing in this case, but think what if we had 10, 30 or even 100 columns. The gain would be quite substantial.</p>
<p>Anyway, based on the means it appears that the three species differ slightly in their body masses. Still, in connection with the standard deviations, we can see that the body masses in the groups overlap slightly. So, is it enough to claim that they are statistically different at the cutoff level of 0.05 (<span class="math inline">\(\alpha\)</span>)? Let’s test that with the one-way ANOVA that we met in the previous chapter.</p>
<p>Let’s start by checking the assumptions. First, the normality assumption</p>
<pre class="language-julia"><code>[Pg.normality(miceBwtABC[!, n]).pval[1] for n in Dfs.names(miceBwtABC)] |&gt;
pvals -&gt; map(pv -&gt; pv &gt; 0.05, pvals) |&gt;
all</code></pre>
<p>true</p>
<p>All normal. Here we get the p-values from Shapiro-Wilk test for all our groups. The documentation for <a href="https://github.com/clementpoiret/Pingouin.jl">Pingouin</a> (and some tries and errors) shows that to get the p-value alone you must type <code>Pg.normality(vector).pval[1]</code>. Then we pipe (<code>|&gt;</code>, see: Section <a href="./statistics_prob_distribution.html#sec:statistics_prob_distribution">4.5</a>) the result to <code>map</code> to check if the p-values (<code>pvals</code>) are greater than 0.05 (then we do not reject the null hypothesis of normal distribution). Finally, we pipe (<code>|&gt;</code>) the <code>Vector{Bool}</code> to <a href="https://docs.julialang.org/en/v1/base/collections/#Base.all-Tuple%7BAny%7D">all</a> which returns <code>true</code> only if all the elements of the vector are true.</p>
<p>OK, time for the homogeneity of variance assumption</p>
<pre class="language-julia"><code>Htests.FlignerKilleenTest(
    [miceBwtABC[!, n] for n in Dfs.names(miceBwtABC)]...
    ) |&gt; Htests.pvalue |&gt; pv -&gt; pv &gt; 0.05</code></pre>
<p>true</p>
<p>The variances are roughly equal. Here <code>[miceBwtABC[!, n] for n in Dfs.names(miceBwtABC)]</code> returns <code>Vector{Vector{&lt;:Real}}</code> so vector of vectors, e.g. <code>[[1, 2], [3, 4], [5, 6]]</code> but <code>Htests.FlingerTest</code> expects separate vectors <code>[1, 2], [3, 4], [5, 6]</code> (no outer square brackets). The splat operator (<code>...</code>) placed after the array removes the outer square brackets. Then we pipe the result of the test <code>Htests.FlingerTest</code> to <code>Htests.pvalue</code> because according to <a href="https://juliastats.org/HypothesisTests.jl/stable/">the documentation</a> it extracts the p-value from the result of the test. Finally, we pipe (<code>|&gt;</code>) the result to an anonymous function (<code>pv -&gt; pv &gt; 0.05</code>) to check if the p-value is greater than 0.05 (then we do not reject the null hypothesis of variance homogeneity).</p>
<p>OK, and now for the one-way ANOVA.</p>
<pre class="language-julia"><code>Htests.OneWayANOVATest(
    [miceBwtABC[!, n] for n in Dfs.names(miceBwtABC)]...
    ) |&gt; Htests.pvalue</code></pre>
<p>0.0006608056579183928</p>
<p>Hmm, OK, the p-value is lower than the cutoff level of 0.05. What now. Well, by doing one-way ANOVA you ask your computer a very specific question: “Does at least one of the group means differs from the other(s)?” The computer does exactly what you tell it, nothing more, nothing less. Here, it answers your question precisely with: “Yes” (since <span class="math inline">\(p \le 0.05\)</span>). I assume that right now you are not satisfied with the answer. After all, what good is it if you still don’t know which group(s) differ one from another: <code>spA</code> vs. <code>spB</code> and/or <code>spA</code> vs <code>spC</code> and/or <code>spB</code> vs <code>spC</code>. If you want your computer to tell you that then you must ask it directly to do so. That is what post-hoc tests are for (<code>post hoc</code> means <code>after the event</code>, here the event is one-way ANOVA).</p>
<p>The split to one-way ANOVA and post-hoc tests made perfect sense in the 1920s-30s and the decades after the method was introduced. Back then you performed calculations with a pen and paper (perhaps a calculator as well). Once one-way ANOVA produced p-value greater than 0.05 you stopped. Otherwise, and only then, you performed a post-hoc test (again with a pen and paper). Anyway, as mentioned in Section <a href="./statistics_intro_exercises_solutions.html#sec:statistics_intro_exercise4_solution">4.9.4</a> the popular choices for post-hoc tests include Fisher’s LSD test and Tukey’s HSD test. Here we are going to use a more universal approach and apply a so called <code>pairwise t-test</code> (which is just a t-test, that you already know, done between every pairs of groups). Ready, here we go</p>
<pre class="language-julia"><code>evtt = Htests.EqualVarianceTTest
getPval = Htests.pvalue

# for &quot;spA vs spB&quot;, &quot;spA vs spC&quot; and &quot;spB vs spC&quot;, respectively
postHocPvals = [
evtt(miceBwtABC[!, &quot;spA&quot;], miceBwtABC[!, &quot;spB&quot;]) |&gt; getPval,
evtt(miceBwtABC[!, &quot;spA&quot;], miceBwtABC[!, &quot;spC&quot;]) |&gt; getPval,
evtt(miceBwtABC[!, &quot;spB&quot;], miceBwtABC[!, &quot;spC&quot;]) |&gt; getPval,
]

postHocPvals</code></pre>
<pre class="output"><code>[0.025111501405268754, 0.0003985445257645916, 0.049332195639921715]</code></pre>
<p>OK, here to save us some typing we assigned the long function names (<code>Htests.EqualVarianceTTest</code> and <code>Htests.pvalue</code>) to the shorter ones (<code>evtt</code> and <code>getPval</code>). Then we used them to conduct the t-tests and extract the p-values for all the possible pairs to compare (we will develop some more user friendly functions in the upcoming exercises, see Section <a href="./compare_contin_data_exercises.html#sec:compare_contin_data_ex4">5.7.4</a>). Anyway, it appears that here any mouse species differs with respect to their average body weight from the other two species (all p-vaues are below 0.05). Or does it?</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="./compare_contin_data_one_way_anova.html"><b>5.4</b> One-way ANOVA</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="./compare_contin_data_multip_correction.html"><b>5.6</b> Multiplicity correction</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Bartlomiej Lukaszuk
</div>
</div>
</div>
</body>
</html>