<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Bartlomiej Lukaszuk" />
  <title>Probability - theory and practice - Romeo and Julia, where Romeo is Basic Statistics</title>
  <link rel="stylesheet" href="./style.css"/>
    <script src="./mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("./JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="./github.min.css">
<script src="./highlight.min.js"></script>
<script src="./julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="./">Romeo and Julia, where Romeo is Basic Statistics</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="./about.html"><b>1</b> About</a></li>
<li><a class="menu-level-1" href="./why_julia.html"><b>2</b> Why Julia</a></li>
<li><a class="menu-level-2" href="./julia_is_fast.html"><b>2.1</b> Julia is fast</a></li>
<li><a class="menu-level-2" href="./julia_is_simple.html"><b>2.2</b> Julia is simple</a></li>
<li><a class="menu-level-2" href="./jl_pleasure_to_write.html"><b>2.3</b> Pleasure to write</a></li>
<li><a class="menu-level-2" href="./jl_not_mainstream.html"><b>2.4</b> Not mainstream</a></li>
<li><a class="menu-level-2" href="./jl_open_source.html"><b>2.5</b> Julia is free</a></li>
<li><a class="menu-level-1" href="./julia_first_encounter.html"><b>3</b> Julia - first encounter</a></li>
<li><a class="menu-level-2" href="./julia_installation.html"><b>3.1</b> Installation</a></li>
<li><a class="menu-level-2" href="./julia_language_constructs.html"><b>3.2</b> Language Constructs</a></li>
<li><a class="menu-level-2" href="./julia_language_variables.html"><b>3.3</b> Variables</a></li>
<li><a class="menu-level-2" href="./julia_language_functions.html"><b>3.4</b> Functions</a></li>
<li><a class="menu-level-2" href="./julia_language_decision_making.html"><b>3.5</b> Decision Making</a></li>
<li><a class="menu-level-2" href="./julia_language_repetition.html"><b>3.6</b> Repetition</a></li>
<li><a class="menu-level-2" href="./julia_language_libraries.html"><b>3.7</b> Additional libraries</a></li>
<li><a class="menu-level-2" href="./julia_language_exercises.html"><b>3.8</b> Julia - Exercises</a></li>
<li><a class="menu-level-2" href="./julia_language_exercises_solutions.html"><b>3.9</b> Julia - Solutions</a></li>
<li><a class="menu-level-1" href="./statistics_intro.html"><b>4</b> Statistics - introduction</a></li>
<li><a class="menu-level-2" href="./statistics_intro_imports.html"><b>4.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./statistics_intro_probability_definition.html"><b>4.2</b> Probability - definition</a></li>
<li><a class="menu-level-2" href="./statistics_intro_probability_properties.html"><b>4.3</b> Probability - properties</a></li>
<li><a class="menu-level-2" href="./statistics_prob_theor_practice.html"><b>4.4</b> Probability - theory and..</a></li>
<li><a class="menu-level-2" href="./statistics_prob_distribution.html"><b>4.5</b> Probability distribution</a></li>
<li><a class="menu-level-2" href="./statistics_normal_distribution.html"><b>4.6</b> Normal distribution</a></li>
<li><a class="menu-level-2" href="./statistics_intro_hypothesis_testing.html"><b>4.7</b> Hypothesis testing</a></li>
<li><a class="menu-level-2" href="./statistics_intro_exercises.html"><b>4.8</b> Statistics intro - Exerc..</a></li>
<li><a class="menu-level-2" href="./statistics_intro_exercises_solutions.html"><b>4.9</b> Statistics intro - Solut..</a></li>
<li><a class="menu-level-1" href="./compare_contin_data.html"><b>5</b> Comparisons - continuous d..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_imports.html"><b>5.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_one_samp_ttest.html"><b>5.2</b> One sample Student’s t..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_two_samp_ttest.html"><b>5.3</b> Two samples Student’s ..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_one_way_anova.html"><b>5.4</b> One-way ANOVA</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_post_hoc_tests.html"><b>5.5</b> Post-hoc tests</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_multip_correction.html"><b>5.6</b> Multiplicity correction</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_exercises.html"><b>5.7</b> Exercises - Comparisons ..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_exercises_solutions.html"><b>5.8</b> Solutions - Comparisons ..</a></li>
<li><a class="menu-level-1" href="./compare_categ_data.html"><b>6</b> Comparisons - categorical ..</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_imports.html"><b>6.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_flashback.html"><b>6.2</b> Flashback</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_chisq_test.html"><b>6.3</b> Chi squared test</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_fisher_exact_text.html"><b>6.4</b> Fisher’s exact test</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_bigger_table.html"><b>6.5</b> Bigger table</a></li>
<li><a class="menu-level-2" href="./compare_categ_test_for_independence.html"><b>6.6</b> Test for independence</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_exercises.html"><b>6.7</b> Exercises - Comparisons ..</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_exercises_solutions.html"><b>6.8</b> Solutions - Comparisons ..</a></li>
<li><a class="menu-level-1" href="./appendix.html"><b></b> Appendix</a></li>
<li><a class="menu-level-1" href="./references.html"><b>7</b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="4.4" id="sec:statistics_prob_theor_practice"><span class="header-section-number">4.4</span> Probability - theory and practice</h2>
<p>OK, in the previous chapter (see Section <a href="./statistics_intro_probability_properties.html#sec:statistics_intro_probability_properties">4.3</a>) we said that a person with blood group AB would produce gametes <code>A</code> and <code>B</code> with probability 50% (p = <span class="math inline">\(\frac{1}{2}\)</span> = 0.5) each. A reference value for <a href="https://en.wikipedia.org/wiki/Semen_analysis#Sperm_count">sperm count</a> is 16’000’000 per mL or 16’000 per <span class="math inline">\(\mu L\)</span>. Given that last value, we would expect 8’000 cells (16’000 * 0.5) to contain allele <code>A</code> and 8’000 (16’000 * 0.5) cells to contain allele <code>B</code>.</p>
<p>Let’s put that to the test.</p>
<p>Wait! Hold your horses! We’re not going to take biological samples. Instead we will do a computer simulation.</p>
<pre class="language-julia"><code>import Random as Rand
Rand.seed!(321) # optional, needed for reproducibility
gametes = Rand.rand([&quot;A&quot;, &quot;B&quot;], 16_000)
first(gametes, 5)</code></pre>
<pre class="output"><code>[&quot;B&quot;, &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;B&quot;]</code></pre>
<p>First we import a package to generate random numbers (<code>import Random as Rand</code>). Then we set seed to some arbitrary number (<code>Rand.seed!(321)</code>) in order to reproduce the results <a href="https://docs.julialang.org/en/v1/stdlib/Random/#Random.seed!">see the docs</a>. Thanks to the above you should get the exact same result as I did (assuming you’re using the same version of Julia). Then we draw 16’000 gametes out of two available (<code>gametes = Rand.rand(["A", "B"], 16_000)</code>) with function <code>rand</code> (drawing with replacement) from <code>Random</code> library (imported as <code>Rand</code>). Finally, since looking through all 16’000 gametes is tedious we display only first 5 (<code>first(gametes, 5)</code>) to have a sneak peak of the result.</p>
<p>Let’s write a function that will calculate the number of gametes for us.</p>
<pre class="language-julia"><code>function getCounts(v::Vector{T})::Dict{T,Int} where {T}
    counts::Dict{T,Int} = Dict()
    for elt in v
        counts[elt] = get(counts, elt, 0) + 1
    end
    return counts
end

function getProbs(counts::Dict{T,Int})::Dict{T,Float64} where {T}
    total::Int = sum(values(counts))
    return Dict(k =&gt; v / total for (k, v) in counts)
end

function getSortedKeysVals(d::Dict{T1,T2})::Tuple{
    Vector{T1},Vector{T2}} where {T1,T2}

    sortedKeys::Vector{T1} = keys(d) |&gt; collect |&gt; sort
    sortedVals::Vector{T2} = [d[k] for k in sortedKeys]
    return (sortedKeys, sortedVals)
end</code></pre>
<p>Try to figure out what happened here on your own. If you need a refresher on dictionaries in Julia see Section <a href="./julia_language_decision_making.html#sec:julia_language_dictionaries">3.5.3</a> or <a href="https://docs.julialang.org/en/v1/base/collections/#Base.Dict">the docs</a>.</p>
<p>Briefly, first we initialize an empty dictionary (<code>counts::Dict{T,Int} = Dict()</code>) with keys of some type <code>T</code> (elements of that type compose Vector <code>v</code>). Next, for every element (<code>elt</code>) in Vector <code>v</code> we check if it is present in the <code>counts</code> (<code>if haskey(counts, elt)</code>). If it is we add 1 to the previous count (<code>counts[elt] = counts[elt] + 1</code>). If not (<code>else</code>) we put the key (<code>elt</code>) into the dictionary with count <code>1</code>. In the end we return the result (<code>return counts</code>). The <code>if ... else</code> block (lines with comments <code>#1</code>-<code>#5</code>) could be replaced with one line (<code>counts[elt] = get(counts, elt, 0) + 1</code>), but I thought the more verbose version would be easier to understand.</p>
<p>Let’s test it out.</p>
<pre class="language-julia"><code>gametesCounts = getCounts(gametes)
gametesCounts</code></pre>
<pre class="output"><code>Dict{String, Int64} with 2 entries:
  &quot;B&quot; =&gt; 8082
  &quot;A&quot; =&gt; 7918</code></pre>
<p>Hmm, that’s odd. We were suppose to get 8’000 gametes with allele <code>A</code> and 8’000 with allele <code>B</code>. What happened? Well, reality. After all <a href="https://en.wikipedia.org/wiki/All_models_are_wrong">“All models are wrong, but some are useful”</a>. Our theoretical reasoning was only approximation of the real world and as such cannot be precise (although with greater sample sizes comes greater precision). You can imagine that a fraction of the gametes were damaged (e.g. due to some unspecified environmental factors) and underwent apoptosis (aka programmed cell death). So that’s how it is, deal with it.</p>
<p>OK, let’s see what are the experimental probabilities we got from our hmm… experiment.</p>
<pre class="language-julia"><code>function getProbs(counts::Dict{T, Int})::Dict{T,Float64} where {T}
    total::Int = sum(values(counts))
    return Dict(k =&gt; v/total for (k, v) in counts)
end</code></pre>
<p>First we calculate total counts no matter the gamete category (<code>sum(values(counts))</code>). Then we use dictionary comprehensions, which are similar to comprehensions we met before (see Section <a href="./julia_language_repetition.html#sec:julia_language_comprehensions">3.6.4</a>). Briefly, for each key and value in <code>counts</code> (<code>for (k,v) in counts</code>) we create the same key in new dictionary with new value being the proportion of <code>v</code> in <code>total</code> (<code>k =&gt; v/total</code>).</p>
<p>And now the experimental probabilities.</p>
<pre class="language-julia"><code>gametesProbs = getProbs(gametesCounts)
gametesProbs</code></pre>
<pre class="output"><code>Dict{String, Float64} with 2 entries:
  &quot;B&quot; =&gt; 0.505125
  &quot;A&quot; =&gt; 0.494875</code></pre>
<p>One last point. While writing numerous programs I figured out it is some times better to represent things (internally) as numbers and only in the last step present them in a more pleasant visual form to the viewer. In our case we could have used <code>0</code> as allele <code>A</code> and <code>1</code> as allele <code>B</code> like so.</p>
<pre class="language-julia"><code>Rand.seed!(321)
gametes = Rand.rand([0, 1], 16_000)
first(gametes, 5)</code></pre>
<pre class="output"><code>[1, 0, 1, 0, 1]</code></pre>
<p>Then to get the counts of the alleles I could type:</p>
<pre class="language-julia"><code>alleleBCount = sum(gametes)
alleleACount = length(gametes) - alleleBCount
(alleleACount, alleleBCount)</code></pre>
<pre class="output"><code>(7918, 8082)</code></pre>
<p>And to get the probabilities for the alleles I could simply type:</p>
<pre class="language-julia"><code>alleleBProb = sum(gametes) / length(gametes)
alleleAProb = 1 - alleleBProb
(round(alleleAProb, digits=6), round(alleleBProb, digits=6))</code></pre>
<pre class="output"><code>(0.494875, 0.505125)</code></pre>
<p>Go ahead. Compare the numbers with those that you got previously and explain it to yourself why this second approach works. Once you’re done click the right arrow to explore probability distributions in the next section.</p>
<blockquote>
<p><strong><em>Note:</em></strong> Similar functionality to <code>getCounts</code> and <code>getProbs</code> can be found in StatsBase.jl, see: <a href="https://juliastats.org/StatsBase.jl/stable/counts/#StatsBase.countmap">countmap</a> and <a href="https://juliastats.org/StatsBase.jl/stable/counts/#StatsBase.proportionmap">proportionmap</a>.</p>
</blockquote>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="./statistics_intro_probability_properties.html"><b>4.3</b> Probability - properties</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="./statistics_prob_distribution.html"><b>4.5</b> Probability distribution</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Bartlomiej Lukaszuk
</div>
</div>
</div>
</body>
</html>