<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Bartlomiej Lukaszuk" />
  <title>Exercises - Comparisons of Continuous Data - Romeo and Julia, where Romeo is Basic Statistics</title>
  <link rel="stylesheet" href="./style.css"/>
    <script src="./mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("./JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="./github.min.css">
<script src="./highlight.min.js"></script>
<script src="./julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="./">Romeo and Julia, where Romeo is Basic Statistics</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="./about.html"><b>1</b> About</a></li>
<li><a class="menu-level-1" href="./why_julia.html"><b>2</b> Why Julia</a></li>
<li><a class="menu-level-2" href="./julia_is_fast.html"><b>2.1</b> Julia is fast</a></li>
<li><a class="menu-level-2" href="./julia_is_simple.html"><b>2.2</b> Julia is simple</a></li>
<li><a class="menu-level-2" href="./jl_pleasure_to_write.html"><b>2.3</b> Pleasure to write</a></li>
<li><a class="menu-level-2" href="./jl_not_mainstream.html"><b>2.4</b> Not mainstream</a></li>
<li><a class="menu-level-2" href="./jl_open_source.html"><b>2.5</b> Julia is free</a></li>
<li><a class="menu-level-1" href="./julia_first_encounter.html"><b>3</b> Julia - first encounter</a></li>
<li><a class="menu-level-2" href="./julia_installation.html"><b>3.1</b> Installation</a></li>
<li><a class="menu-level-2" href="./julia_language_constructs.html"><b>3.2</b> Language Constructs</a></li>
<li><a class="menu-level-2" href="./julia_language_variables.html"><b>3.3</b> Variables</a></li>
<li><a class="menu-level-2" href="./julia_language_functions.html"><b>3.4</b> Functions</a></li>
<li><a class="menu-level-2" href="./julia_language_decision_making.html"><b>3.5</b> Decision Making</a></li>
<li><a class="menu-level-2" href="./julia_language_repetition.html"><b>3.6</b> Repetition</a></li>
<li><a class="menu-level-2" href="./julia_language_libraries.html"><b>3.7</b> Additional libraries</a></li>
<li><a class="menu-level-2" href="./julia_language_exercises.html"><b>3.8</b> Julia - Exercises</a></li>
<li><a class="menu-level-2" href="./julia_language_exercises_solutions.html"><b>3.9</b> Julia - Solutions</a></li>
<li><a class="menu-level-1" href="./statistics_intro.html"><b>4</b> Statistics - introduction</a></li>
<li><a class="menu-level-2" href="./statistics_intro_imports.html"><b>4.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./statistics_intro_probability_definition.html"><b>4.2</b> Probability - definition</a></li>
<li><a class="menu-level-2" href="./statistics_intro_probability_properties.html"><b>4.3</b> Probability - properties</a></li>
<li><a class="menu-level-2" href="./statistics_prob_theor_practice.html"><b>4.4</b> Probability - theory and..</a></li>
<li><a class="menu-level-2" href="./statistics_prob_distribution.html"><b>4.5</b> Probability distribution</a></li>
<li><a class="menu-level-2" href="./statistics_normal_distribution.html"><b>4.6</b> Normal distribution</a></li>
<li><a class="menu-level-2" href="./statistics_intro_hypothesis_testing.html"><b>4.7</b> Hypothesis testing</a></li>
<li><a class="menu-level-2" href="./statistics_intro_exercises.html"><b>4.8</b> Statistics intro - Exerc..</a></li>
<li><a class="menu-level-2" href="./statistics_intro_exercises_solutions.html"><b>4.9</b> Statistics intro - Solut..</a></li>
<li><a class="menu-level-1" href="./compare_contin_data.html"><b>5</b> Comparisons - continuous d..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_imports.html"><b>5.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_one_samp_ttest.html"><b>5.2</b> One sample Student’s t..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_two_samp_ttest.html"><b>5.3</b> Two samples Student’s ..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_one_way_anova.html"><b>5.4</b> One-way ANOVA</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_post_hoc_tests.html"><b>5.5</b> Post-hoc tests</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_multip_correction.html"><b>5.6</b> Multiplicity correction</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_exercises.html"><b>5.7</b> Exercises - Comparisons ..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_exercises_solutions.html"><b>5.8</b> Solutions - Comparisons ..</a></li>
<li><a class="menu-level-1" href="./compare_categ_data.html"><b>6</b> Comparisons - categorical ..</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_imports.html"><b>6.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_flashback.html"><b>6.2</b> Flashback</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_chisq_test.html"><b>6.3</b> Chi squared test</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_fisher_exact_text.html"><b>6.4</b> Fisher’s exact test</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_bigger_table.html"><b>6.5</b> Bigger table</a></li>
<li><a class="menu-level-2" href="./compare_categ_test_for_independence.html"><b>6.6</b> Test for independence</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_exercises.html"><b>6.7</b> Exercises - Comparisons ..</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_exercises_solutions.html"><b>6.8</b> Solutions - Comparisons ..</a></li>
<li><a class="menu-level-1" href="./assoc_and_pred.html"><b>7</b> Association and Prediction</a></li>
<li><a class="menu-level-2" href="./assoc_and_pred_data_imports.html"><b>7.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./assoc_and_pred_association.html"><b>7.2</b> Association</a></li>
<li><a class="menu-level-1" href="./appendix.html"><b></b> Appendix</a></li>
<li><a class="menu-level-1" href="./references.html"><b>8</b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="5.7" id="sec:compare_contin_data_exercises"><span class="header-section-number">5.7</span> Exercises - Comparisons of Continuous Data</h2>
<p>Just like in the previous chapters here you will find some exercises that you may want to solve to get from this chapter as much as you can (best option). Alternatively, you may read the task descriptions and the solutions (and try to understand them).</p>
<h3 data-number="5.7.1" id="sec:compare_contin_data_ex1"><span class="header-section-number">5.7.1</span> Exercise 1</h3>
<p>In Section <a href="./compare_contin_data_one_samp_ttest.html#sec:compare_contin_data_one_samp_ttest">5.2</a> we said that when we draw a small random sample from a normal distribution of a given mean (<span class="math inline">\(\mu\)</span>) and standard deviation (<span class="math inline">\(\sigma\)</span>) then the distribution of the sample means will be pseudo-normal with the mean roughly equal to the population mean and the standard deviation roughly equal to sem (standard error of the mean).</p>
<p>Time to confirm it. Moreover, it’s time to practice our plotting skills (I think we neglected them so far).</p>
<p>In this task your population of interest is <code>Dsts.Normal(80, 20)</code>. To make it more concrete let’s say this is the distribution of body weight for adult humans. To plot you may use <a href="https://docs.makie.org/stable/documentation/backends/cairomakie/">CairoMakie</a> or some other plotting library (read the tutorial(s)/docs first).</p>
<ol type="1">
<li>draw a random sample of size 10 from the population <code>Dsts.Normal(80, 20)</code>. Calculate <code>sem</code> and <code>sd</code> for the sample,</li>
<li>draw 100’000 random samples of size 10 from the population <code>Dsts.Normal(80, 200)</code> and calculate the samples means (100’000 sample means)</li>
<li>draw the histogram of the sample means from point 2 using, e.g. <a href="https://docs.makie.org/stable/examples/plotting_functions/hist/index.html#hist">Cmk.hist</a>. Afterwards, you may set the y-axis limits from 0 to 4000, with <code>Cmk.ylims!(0, 4000)</code>.</li>
<li>on the histogram mark the population mean (<span class="math inline">\(\mu = 80\)</span>) with a vertical line using, e.g. <a href="https://docs.makie.org/stable/examples/plotting_functions/hvlines/index.html#vlines">Cmk.vlines</a></li>
<li>annotate the line from point 4 (e.g. type “population mean = 80”) using, e.g. <a href="https://docs.makie.org/stable/examples/plotting_functions/text/index.html#text">Cmk.text</a></li>
<li>on the histogram mark the means standard deviation using, e.g. <a href="https://docs.makie.org/stable/examples/plotting_functions/bracket/">Cmk.bracket</a>,</li>
<li>annotate the histogram (above the bracket from point 6) with the means standard deviation, using, e.g. <a href="https://docs.makie.org/stable/examples/plotting_functions/text/index.html#text">Cmk.text</a>,</li>
<li>annotate the histogram with the sample’s <code>sem</code> and <code>sd</code> (from point 1) and compare them with the means standard deviation from point 7.</li>
</ol>
<p>And that’s it. This may look like a lot of work to do, but don’t freak out, do it one point at a time, look at the instructions (they are pretty precise on purpose).</p>
<p><em>Hint. Remember that each of those functions may have a substitute that ends with <code>!</code> (a function that modifies an already existing figure). It is for you to decide when to use which version of a plotting function.</em></p>
<h3 data-number="5.7.2" id="sec:compare_contin_data_ex2"><span class="header-section-number">5.7.2</span> Exercise 2</h3>
<p>Do you remember how in Section <a href="./compare_contin_data_one_way_anova.html#sec:compare_contin_data_one_way_anova">5.4</a> we calculated the L-statistic for <code>ex2BwtsWater</code> and <code>ex2BwtsDrugY</code> and find out its value was equal to <code>LStatisticEx2</code> = 1.28? Then we calculated the famous F-statistics for the same two groups (<code>ex2BwtsWater</code> and <code>ex2BwtsDrugY</code>) and it was equal to <code>getFStatistic(ex2BwtsWater, ex2BwtsDrugY)</code> = 6.56. The probability of obtaining an F-value greater than this (by chance) if <span class="math inline">\(H_{0}\)</span> is true (i.e. both groups come from the same distribution (<code>Dsts.Normal(25, 3)</code>) is equal to:</p>
<pre class="language-julia"><code># the way we calculated it in the chapter (more or less)
Htests.OneWayANOVATest(ex2BwtsWater, ex2BwtsDrugY) |&gt; Htests.pvalue</code></pre>
<p>0.042836426298994756</p>
<p>Alternatively, we cold calculate it also with our friendly <code>Distributions</code> package (similarly to how we used in in, e.g. Section <a href="./statistics_normal_distribution.html#sec:statistics_intro_distributions_package">4.6.2</a>)</p>
<pre class="language-julia"><code># the way we can calculate it with Distributions package
# 1 - Dfs for groups (number of groups - 1),
# 6 - Dfs for residuals (number of observations - number of groups)
1 - Dsts.cdf(Dsts.FDist(1, 6), getFStatistic(ex2BwtsWater, ex2BwtsDrugY))</code></pre>
<p>0.042836426298994756</p>
<p>Hopefully, you remember that. OK, here is the task.</p>
<ol type="1">
<li><p>write a function <code>getLStatistic(v1::Vector{&lt;:Real}, v2::Vector{&lt;:Real})::Float64</code> that calculates the L-Statistic for two given vectors</p></li>
<li><p>estimate the L-Distribution. To do that:</p>
<p>2.1) run, let’s say 1’000’000 simulations under <span class="math inline">\(H_{0}\)</span> that <code>v1</code> and <code>v2</code> come from the same population (<code>Dsts.Normal(25, 3)</code>, draw 4 observations per vector). Calculate the L-Statistic each time (round it to 1 decimal place, like <code>round(getLStatistic(v1, v2), digits=1)</code></p>
<p>2.2) use <code>getCounts</code> (Section <a href="./statistics_prob_theor_practice.html#sec:statistics_prob_theor_practice">4.4</a>), <code>getProbs</code> (Section <a href="./statistics_prob_theor_practice.html#sec:statistics_prob_theor_practice">4.4</a>) and <code>getSortedKeysVals</code> (Section <a href="./statistics_prob_distribution.html#sec:statistics_prob_distribution">4.5</a>) to obtain the probabilities for each value of the L-Statistic produced in point 2.1</p>
<p>2.3) based on the data from point 2.2 calculate the probability of L-Statistic being greater than <code>LStatisticEx2</code> = 1.28. Compare the probability with the probability obtained for the F-Statistics (presented in the code snippets above)</p></li>
<li><p>using, e.g. <a href="https://docs.makie.org/stable/examples/plotting_functions/lines/index.html#lines">Cmk.lines</a> (<code>color="blue"</code>) and the data from point 2.2 plot the probability distribution for the L-Distribution</p></li>
<li><p>add vertical line, e.g with <code>Cmk.vlines</code> at L-Statistic = 1.28, annotate the line with <code>Cmk.text</code></p></li>
<li><p>check what happens if both the samples from point 2.1 come from a different population (e.g. <code>Dsts.Normal(100, 50)</code>). Plot the new distribution on the old one (point 3) with, e.g. <a href="https://docs.makie.org/stable/examples/plotting_functions/scatter/index.html#scatter">Cmk.scatter</a> (<code>marker=:circle</code>, <code>color="blue"</code>).</p></li>
<li><p>check what happens if the samples from point 2.1 come from the same distribution (<code>Dsts.Normal(25, 3)</code>) but are of different size (8 observations per vector). Plot the new distribution on the old one (point 3) with, e.g. <code>Cmk.scatter</code> (<code>marker=:xcross</code>, <code>color="blue"</code>).</p></li>
</ol>
<p><em>Optionally, if you want to make your plots more readable and if you like challenges you may:</em></p>
<ol start="7" type="1">
<li>add the F-Distribution to the plot, e.g. with <code>Cmk.lines</code> (<code>color="red"</code>)</li>
<li>add <a href="https://docs.makie.org/stable/examples/blocks/legend/index.html#multi-group_legends">legends</a> to the plots</li>
</ol>
<p>Again. This may look like a lot of work to do, but don’t freak out, do it one point at a time, look at the instructions (they are pretty precise on purpose).</p>
<h3 data-number="5.7.3" id="sec:compare_contin_data_ex3"><span class="header-section-number">5.7.3</span> Exercise 3</h3>
<p>Let’s cool down after the last two demanding exercises.</p>
<p>In this task I want you to write the function <code>getPValUnpairedTest(v1::Vector{&lt;:Real}, v2::Vector{&lt;:Real})::Float64</code>. The function accepts two vectors runs an unpaired test and returns the p-value.</p>
<p>The function should check the:</p>
<ol type="1">
<li>normality (<code>Pg.normality</code>), and</li>
<li>homogeneity of variance (<code>Htests.FlingerTest</code>)</li>
</ol>
<p>assumptions.</p>
<p>If both the assumptions hold then run <code>Htests.EqualVarianceTTest</code>.</p>
<p>If only normality assumption holds then the <code>Htests.UnequalVarianceTTest</code>.</p>
<p>Otherwise run <code>Htests.MannWhitneyUTest</code>.</p>
<h3 data-number="5.7.4" id="sec:compare_contin_data_ex4"><span class="header-section-number">5.7.4</span> Exercise 4</h3>
<p>Write a function with the following signature</p>
<pre>
function getPValsUnpairedTests(
    df::Dfs.DataFrame
    )::Dict{Tuple{String,String},Float64}
</pre>
<p>The function accepts a data frame (like <code>miceBwtABC</code> we met in Section <a href="./compare_contin_data_post_hoc_tests.html#sec:compare_contin_data_post_hoc_tests">5.5</a>). Then it runs the appropriate comparisons (use <code>getPValUnpairedTest</code> that you developed in Section <a href="./compare_contin_data_exercises.html#sec:compare_contin_data_ex3">5.7.3</a>) and returns the p-values for comparisons in the form of a dictionary where the keys are the names of the compared groups (<code>Tuple{String, String}</code>), and the values are pvalues (e.g. <code>Dict(("grX", "grY") =&gt; 0.3, ("grX", "grZ") =&gt; 0.022)</code>. The function should compare every group with every other group.</p>
<p>Once you are done with this task tweak your function slightly to have the following signature</p>
<pre>
function getPValsUnpairedTests(
    df::Dfs.DataFrame,
    multCorr
    )::Dict{Tuple{String,String},Float64}
</pre>
<p>This function adjusts the obtained p-values using some sort of multiplicity correction (<code>multCorr</code>) from <code>MultipleTesting</code> package we discussed before (Section <a href="./compare_contin_data_multip_correction.html#sec:compare_contin_data_multip_correction">5.6</a>).</p>
<p>Test your function on <code>miceBwtABC</code> and compare the results with those we obtained in Section <a href="./compare_contin_data_post_hoc_tests.html#sec:compare_contin_data_post_hoc_tests">5.5</a> and in Section <a href="./compare_contin_data_multip_correction.html#sec:compare_contin_data_multip_correction">5.6</a>.</p>
<h3 data-number="5.7.5" id="sec:compare_contin_data_ex5"><span class="header-section-number">5.7.5</span> Exercise 5</h3>
<p>It appears that when a scientific paper presents a comparison between few groups of continuous variables it does so in a form of bar-plot or box-plot with some markers for statistically significant differences over the bars/boxes.</p>
<p>So here is your task. For data from <code>miceBwtABC</code> from Section <a href="./compare_contin_data_post_hoc_tests.html#sec:compare_contin_data_post_hoc_tests">5.5</a> write a function that draws a plot similar to the one below (it doesn’t have to be the exact copy).</p>
<figure>
<img src="./images/ch05ex5boxplot.png" id="fig:ch05ex5boxplot" alt="Figure 17: Boxplot of body mass of three mice species. a - difference vs. spA (p &lt; 0.05), b - difference vs. spB (p &lt; 0.05)." /><figcaption aria-hidden="true">Figure 17: Boxplot of body mass of three mice species. a - difference vs. spA (p &lt; 0.05), b - difference vs. spB (p &lt; 0.05).</figcaption>
</figure>
<p>For the task you may use:</p>
<ul>
<li><a href="https://docs.makie.org/stable/examples/plotting_functions/boxplot/index.html#boxplot">Cmk.boxplot</a> - to draw the boxplot</li>
<li><a href="https://docs.makie.org/stable/examples/blocks/axis/index.html#xticks">Cmk.xticks</a> - to add group labels in x-ticks</li>
<li>p-values provided by <code>getPValsUnpairedTests(miceBwtABC, Mt.BenjaminiHochberg)</code> from the last exercise to generate statistical significance markers.</li>
<li><a href="https://docs.makie.org/stable/examples/plotting_functions/text/index.html#text">Cmk.text</a> to place the markers in the correct positions on the plot.</li>
</ul>
<p>The function should also work for different data frames of similar kind with different number of groups in the columns.</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="./compare_contin_data_multip_correction.html"><b>5.6</b> Multiplicity correction</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="./compare_contin_data_exercises_solutions.html"><b>5.8</b> Solutions - Comparisons ..</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Bartlomiej Lukaszuk
</div>
</div>
</div>
</body>
</html>