<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Bartlomiej Lukaszuk" />
  <title>Exercises - Comparisons of Categorical Data - Romeo and Julia, where Romeo is Basic Statistics</title>
  <link rel="stylesheet" href="./style.css"/>
    <script src="./mousetrap.min.js"></script>
    <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("./JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="./github.min.css">
<script src="./highlight.min.js"></script>
<script src="./julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        if (!el.classList.contains('output')) {
            hljs.highlightElement(el);
        }
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="./">Romeo and Julia, where Romeo is Basic Statistics</a>
</div><br />
<span class="books-subtitle">

</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="./about.html"><b>1</b> About</a></li>
<li><a class="menu-level-1" href="./why_julia.html"><b>2</b> Why Julia</a></li>
<li><a class="menu-level-2" href="./julia_is_fast.html"><b>2.1</b> Julia is fast</a></li>
<li><a class="menu-level-2" href="./julia_is_simple.html"><b>2.2</b> Julia is simple</a></li>
<li><a class="menu-level-2" href="./jl_pleasure_to_write.html"><b>2.3</b> Pleasure to write</a></li>
<li><a class="menu-level-2" href="./jl_not_mainstream.html"><b>2.4</b> Not mainstream</a></li>
<li><a class="menu-level-2" href="./jl_open_source.html"><b>2.5</b> Julia is free</a></li>
<li><a class="menu-level-1" href="./julia_first_encounter.html"><b>3</b> Julia - first encounter</a></li>
<li><a class="menu-level-2" href="./julia_installation.html"><b>3.1</b> Installation</a></li>
<li><a class="menu-level-2" href="./julia_language_constructs.html"><b>3.2</b> Language Constructs</a></li>
<li><a class="menu-level-2" href="./julia_language_variables.html"><b>3.3</b> Variables</a></li>
<li><a class="menu-level-2" href="./julia_language_functions.html"><b>3.4</b> Functions</a></li>
<li><a class="menu-level-2" href="./julia_language_decision_making.html"><b>3.5</b> Decision Making</a></li>
<li><a class="menu-level-2" href="./julia_language_repetition.html"><b>3.6</b> Repetition</a></li>
<li><a class="menu-level-2" href="./julia_language_libraries.html"><b>3.7</b> Additional libraries</a></li>
<li><a class="menu-level-2" href="./julia_language_exercises.html"><b>3.8</b> Julia - Exercises</a></li>
<li><a class="menu-level-2" href="./julia_language_exercises_solutions.html"><b>3.9</b> Julia - Solutions</a></li>
<li><a class="menu-level-1" href="./statistics_intro.html"><b>4</b> Statistics - introduction</a></li>
<li><a class="menu-level-2" href="./statistics_intro_imports.html"><b>4.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./statistics_intro_probability_definition.html"><b>4.2</b> Probability - definition</a></li>
<li><a class="menu-level-2" href="./statistics_intro_probability_properties.html"><b>4.3</b> Probability - properties</a></li>
<li><a class="menu-level-2" href="./statistics_prob_theor_practice.html"><b>4.4</b> Probability - theory and..</a></li>
<li><a class="menu-level-2" href="./statistics_prob_distribution.html"><b>4.5</b> Probability distribution</a></li>
<li><a class="menu-level-2" href="./statistics_normal_distribution.html"><b>4.6</b> Normal distribution</a></li>
<li><a class="menu-level-2" href="./statistics_intro_hypothesis_testing.html"><b>4.7</b> Hypothesis testing</a></li>
<li><a class="menu-level-2" href="./statistics_intro_exercises.html"><b>4.8</b> Statistics intro - Exerc..</a></li>
<li><a class="menu-level-2" href="./statistics_intro_exercises_solutions.html"><b>4.9</b> Statistics intro - Solut..</a></li>
<li><a class="menu-level-1" href="./compare_contin_data.html"><b>5</b> Comparisons - continuous d..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_imports.html"><b>5.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_one_samp_ttest.html"><b>5.2</b> One sample Student’s t..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_two_samp_ttest.html"><b>5.3</b> Two samples Student’s ..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_one_way_anova.html"><b>5.4</b> One-way ANOVA</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_post_hoc_tests.html"><b>5.5</b> Post-hoc tests</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_multip_correction.html"><b>5.6</b> Multiplicity correction</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_exercises.html"><b>5.7</b> Exercises - Comparisons ..</a></li>
<li><a class="menu-level-2" href="./compare_contin_data_exercises_solutions.html"><b>5.8</b> Solutions - Comparisons ..</a></li>
<li><a class="menu-level-1" href="./compare_categ_data.html"><b>6</b> Comparisons - categorical ..</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_imports.html"><b>6.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_flashback.html"><b>6.2</b> Flashback</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_chisq_test.html"><b>6.3</b> Chi squared test</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_fisher_exact_text.html"><b>6.4</b> Fisher’s exact test</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_bigger_table.html"><b>6.5</b> Bigger table</a></li>
<li><a class="menu-level-2" href="./compare_categ_test_for_independence.html"><b>6.6</b> Test for independence</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_exercises.html"><b>6.7</b> Exercises - Comparisons ..</a></li>
<li><a class="menu-level-2" href="./compare_categ_data_exercises_solutions.html"><b>6.8</b> Solutions - Comparisons ..</a></li>
<li><a class="menu-level-1" href="./association.html"><b>7</b> Association</a></li>
<li><a class="menu-level-2" href="./assoc_and_pred_data_imports.html"><b>7.1</b> Chapter imports</a></li>
<li><a class="menu-level-2" href="./association_lin_relation.html"><b>7.2</b> Linear relation</a></li>
<li><a class="menu-level-2" href="./assocociation_covariance.html"><b>7.3</b> Covariance</a></li>
<li><a class="menu-level-2" href="./assoc_and_pred_correlation.html"><b>7.4</b> Correlation</a></li>
<li><a class="menu-level-2" href="./association_corr_pitfalls.html"><b>7.5</b> Correlation Pitfalls</a></li>
<li><a class="menu-level-2" href="./association_exercises.html"><b>7.6</b> Exercises - Association</a></li>
<li><a class="menu-level-2" href="./association_exercises_solutions.html"><b>7.7</b> Solutions - Association</a></li>
<li><a class="menu-level-1" href="./appendix.html"><b></b> Appendix</a></li>
<li><a class="menu-level-1" href="./references.html"><b>8</b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="6.7" id="sec:compare_categ_data_exercises"><span class="header-section-number">6.7</span> Exercises - Comparisons of Categorical Data</h2>
<p>Just like in the previous chapters here you will find some exercises that you may want to solve to get from this chapter as much as you can (best option). Alternatively, you may read the task descriptions and the solutions (and try to understand them).</p>
<h3 data-number="6.7.1" id="sec:compare_categ_data_ex1"><span class="header-section-number">6.7.1</span> Exercise 1</h3>
<p>In Section <a href="./compare_categ_data_chisq_test.html#sec:compare_categ_data_chisq_test">6.3</a> and Section <a href="./compare_categ_data_bigger_table.html#sec:compare_categ_data_bigger_table">6.5</a> we dealt with <code>dfEyeColor</code> and <code>dfEyeColorFull</code>, i.e. the data sets that were already in the form of a contingency table. Usually, this is not the case.</p>
<p>Imagine that you are a researcher and you want to find out if certain professions are associated with a greater risk of smoking cigarettes (perhaps as a way to alleviate the stress). So you prepare a questionnaire. People answer two questions: “Q1. What is your profession?” and “Q2. Do you smoke?” The answers to Q1 are placed in one column of a spreadsheet, the answers to Q2 are placed into the second column. An exemplary data could look this way:</p>
<pre class="language-julia"><code>import Random as Rand

Rand.seed!(321)
smoker = Rand.rand([&quot;no&quot;, &quot;yes&quot;], 100)
profession = Rand.rand([&quot;Lawyer&quot;, &quot;Priest&quot;, &quot;Teacher&quot;], 100)</code></pre>
<p>Write a function with the following signature</p>
<pre>
function getContingencyTable(
    rowVect::Vector{String},
    colVect::Vector{String},
    )::Matrix{Int}
</pre>
<p>The function should take two arguments (observations as vectors of strings) and return a contingency table (<code>Matrix{Int}</code>) with the counts (similar to <code>mEyeColor</code> or <code>mEyeColorFull</code>). You may modify the function slightly, e.g to return <code>Dfs.DataFrame</code> similar to the one produced by <a href="https://github.com/nalimilan/FreqTables.jl">FreqTables.freqtable</a> (it doesn’t have to be exact).</p>
<p>Test your function with the data presented above. Make sure it works properly also for smaller data sets, i.e. for</p>
<pre class="language-julia"><code>Rand.seed!(321)
smokerSmall = Rand.rand([&quot;no&quot;, &quot;yes&quot;], 10)
professionSmall = Rand.rand([&quot;Lawyer&quot;, &quot;Priest&quot;, &quot;Teacher&quot;], 10)</code></pre>
<p>the contingency table should contain zeros in some cells.</p>
<p>Below you may find a list of functions that I found useful (you may check them in <a href="https://docs.julialang.org/en/v1/">the docs</a>). Of course you don’t have to use any of them. The functions are sorted alphabetically.</p>
<ul>
<li><code>Dfs.insertcols!</code> (<a href="https://dataframes.juliadata.org/stable/">DataFrames docs</a>)</li>
<li><code>collect</code></li>
<li><code>getCounts</code> (from Section <a href="./statistics_prob_theor_practice.html#sec:statistics_prob_theor_practice">4.4</a>)</li>
<li><code>sort</code></li>
<li><code>unique</code></li>
<li><code>zip</code></li>
</ul>
<h3 data-number="6.7.2" id="sec:compare_categ_data_ex2"><span class="header-section-number">6.7.2</span> Exercise 2</h3>
<p>In Section <a href="./compare_categ_data_chisq_test.html#sec:compare_categ_data_chisq_test">6.3</a> we concluded that the populations of the <code>us</code> and <code>uk</code> differ with respect to eye color distribution (we used data from <code>mEyeColor</code>).</p>
<p>Still, it’s often nice to know not just the numbers themselves, but the proportions (or percentage distribution of the data in a table).</p>
<p>So, here is a task for you. Write the following functions</p>
<pre>
function getColPerc(m::Matrix{Int})::Matrix{Float64}

# and

function getRowPerc(m::Matrix{Int})::Matrix{Float64}
</pre>
<p>that should work similarly to <a href="https://github.com/nalimilan/FreqTables.jl">FreqTables.prop</a> (<code>prop(tbl2, margins=2)</code>, and <code>prop(tbl2, margins=1)</code>), i.e they should return the column and row percentage of observations, respectively.</p>
<p>To reduce code duplication you may want to combine them into a single function, e.g. <code>getPerc(m::Matrix{Int}, byRow::Bool)::Matrix{Float64}</code> that returns row percentages when <code>byRow</code> is true, and column percentages otherwise. You my also want to round the numbers (percents) to e.g. 2 decimal points.</p>
<p>In my solution I used <a href="https://en.wikibooks.org/wiki/Introducing_Julia/Controlling_the_flow#Nested_loops">nested for loops</a>, but feel free to write it whatever way you like (as long as it works fine).</p>
<h3 data-number="6.7.3" id="sec:compare_categ_data_ex3"><span class="header-section-number">6.7.3</span> Exercise 3</h3>
<p>The functions we developed previously (see Section <a href="./compare_categ_data_exercises_solutions.html#sec:compare_categ_data_ex2_solution">6.8.2</a>) are nice and useful. Still, we might want to have a visual aid to help us with the interpretation of our data.</p>
<p>So here is another task for you. Using CairoMakie or your favorite plotting library write a function that accepts a data frame like <code>dfEyeColorFull</code> and draws a stacked bar plot depicting column percentages (search the documentation for <a href="https://docs.makie.org/stable/reference/plots/barplot/">barplot</a>).</p>
<p>You may use the functions we developed before.</p>
<p>If you want you can make your function also draw row percentages (optional).</p>
<h3 data-number="6.7.4" id="sec:compare_categ_data_ex4"><span class="header-section-number">6.7.4</span> Exercise 4</h3>
<p>This exercise is pretty easy and straightforward. In Section <a href="./compare_categ_data_fisher_exact_text.html#sec:compare_categ_data_fisher_exact_text">6.4</a> we said that the chi squared (<span class="math inline">\(\chi^2\)</span>) test requires the table to fulfill a few assumptions, e.g.:</p>
<ul>
<li>total number of observations to be &gt;= 50</li>
<li>the expected number of observations per a cell to be &gt;= 5</li>
</ul>
<p>So here is the task. Write a function with the following signature</p>
<pre>
runCategTestGetPVal(m::Matrix{Int})::Float64
# or
runCategTestGetPVal(df::Dfs.DataFrame)::Float64
</pre>
<p>The function takes a 2x2 matrix (like <code>mEyeColor</code> or <code>mEyeColorSmall</code>) or a data frame (like <code>dfEyeColor</code>). Then the function tests the above mentioned assumptions and runs <code>Htests.ChisqTest</code> or <code>Htests.FisherExactTest</code> on its input and returns the obtained p-value. Feel free to use the functionalities we developed in this chapter (Section <a href="./compare_categ_data.html#sec:compare_categ_data">6</a>) and its sub-chapters.</p>
<h3 data-number="6.7.5" id="sec:compare_categ_data_ex5"><span class="header-section-number">6.7.5</span> Exercise 5</h3>
<p>In Section <a href="./compare_categ_test_for_independence.html#sec:compare_categ_test_for_independence">6.6</a> we analyzed the data in <code>dfEyeColorFull</code> (alternatively <code>mEyeColorFull</code>) and concluded that the distribution of eye color between the two tested countries differed. Still, we were unable to tell which (two eye colors) distributions differ from each other.</p>
<p>So here is the task. Write a function that accepts a matrix (or a data frame if you will) like <code>mEyeColor</code>/<code>dfEyeColorFull</code> (where the number of rows and/or columns with counts is greater than 2). The function should return a vector of all possible 2x2 matrices/data frames (I found <code>getUniquePairs</code> from Section <a href="./compare_contin_data_exercises_solutions.html#sec:compare_contin_data_ex4_solution">5.8.4</a> to be useful here, but you may use whatever you want).</p>
<p>Once you got the data structure with the data frames write another function that runs the appropriate test (<code>runCategTestGetPVal</code> from Section <a href="./compare_categ_data_exercises.html#sec:compare_categ_data_ex4">6.7.4</a> above) on each of the matrices/data frames from the previous paragraph and return the p-values (choose the appropriate data structure).</p>
<p>In the last step write a function that applies a multiplicity correction (see Section <a href="./compare_contin_data_multip_correction.html#sec:compare_contin_data_multip_correction">5.6</a>) to the obtained p-values.</p>
<h3 data-number="6.7.6" id="sec:compare_categ_data_ex6"><span class="header-section-number">6.7.6</span> Exercise 6</h3>
<p>Too cool down let’s end this chapter with something easy but potentially useful.</p>
<p>As you have learned by now in programming we oftten end up using our old functions (or at least I do), although we tend to tweak them a little to adjust them to the ever changing needs.</p>
<p>In this task I want you to change the <code>drawColPerc</code> (or your own solution to Section <a href="./compare_categ_data_exercises.html#sec:compare_categ_data_ex3">6.7.3</a>) from Section <a href="./compare_categ_data_exercises_solutions.html#sec:compare_categ_data_ex3_solution">6.8.3</a>. You can name the new function, e.g. <code>drawColPerc2</code> (wow, how original). The new function should accept among others a bigger data frame (like <code>dfEyeColorFull</code>). Inside it runs <code>runCategTestsGetPVals</code> we developed in Section <a href="./compare_categ_data_exercises_solutions.html#sec:compare_categ_data_ex5_solution">6.8.5</a> (with multiplicity correction). Then it should draw the stacked barplots (it draws one stacked barplot for each data frame, the drawings should be set in one column, but in multiple rows). If the distribution in a data frame is statistically significant add a stroke (<code>strokewidth</code> argument) to the barplot.</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="./compare_categ_test_for_independence.html"><b>6.6</b> Test for independence</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="./compare_categ_data_exercises_solutions.html"><b>6.8</b> Solutions - Comparisons ..</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Bartlomiej Lukaszuk
</div>
</div>
</div>
</body>
</html>